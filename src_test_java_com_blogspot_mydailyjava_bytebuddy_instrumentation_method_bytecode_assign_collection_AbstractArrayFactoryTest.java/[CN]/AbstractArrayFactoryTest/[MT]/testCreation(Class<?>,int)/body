{
  prepareMocksFor(componentType);
  ArrayFactory arrayFactory=ArrayFactory.of(typeDescription);
  Assignment arrayAssignment=arrayFactory.withValues(Arrays.asList(assignment));
  assertThat(arrayAssignment.isValid(),is(true));
  verify(assignment,atLeast(1)).isValid();
  Assignment.Size size=arrayAssignment.apply(methodVisitor);
  assertThat(size.getSizeImpact(),is(1));
  assertThat(size.getMaximalSize(),is(3 + TypeSize.of(componentType).toIncreasingSize().getSizeImpact()));
  verify(methodVisitor).visitInsn(Opcodes.ICONST_1);
  verifyArrayCreation(methodVisitor);
  verify(methodVisitor).visitInsn(Opcodes.DUP);
  verify(methodVisitor).visitInsn(Opcodes.ICONST_0);
  verify(assignment).apply(methodVisitor);
  verify(methodVisitor).visitInsn(storageOpcode);
  verifyNoMoreInteractions(methodVisitor);
  verifyNoMoreInteractions(assignment);
}
