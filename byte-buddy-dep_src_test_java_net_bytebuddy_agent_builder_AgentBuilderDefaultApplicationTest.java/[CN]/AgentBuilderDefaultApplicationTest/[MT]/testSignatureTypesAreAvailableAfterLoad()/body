{
  assertThat(ByteBuddyAgent.install(),instanceOf(Instrumentation.class));
  ClassFileTransformer classFileTransformer=new AgentBuilder.Default().with(typeLocator).ignore(none()).type(isAnnotatedWith(ShouldRebase.class),ElementMatchers.is(classLoader)).transform(new ConstructorTransformer()).installOnByteBuddyAgent();
  try {
    Class<?> type=classLoader.loadClass(Foo.class.getName());
    assertThat(type.getDeclaredConstructors().length,is(2));
    assertThat(type.getConstructor().newInstance(),notNullValue(Object.class));
  }
  finally {
    ByteBuddyAgent.getInstrumentation().removeTransformer(classFileTransformer);
  }
}
