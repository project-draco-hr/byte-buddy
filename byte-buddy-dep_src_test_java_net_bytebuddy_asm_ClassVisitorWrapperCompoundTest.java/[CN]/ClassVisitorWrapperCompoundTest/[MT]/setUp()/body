{
  when(prepend.wrap(prependVisitor)).thenReturn(wrapperVisitor);
  when(wrapper.wrap(wrapperVisitor)).thenReturn(appendVisitor);
  when(append.wrap(appendVisitor)).thenReturn(resultVisitor);
  when(prepend.mergeReader(FOO)).thenReturn(BAR);
  when(wrapper.mergeReader(BAR)).thenReturn(QUX);
  when(append.mergeReader(QUX)).thenReturn(BAZ);
  when(prepend.mergeWriter(FOO)).thenReturn(BAR);
  when(wrapper.mergeWriter(BAR)).thenReturn(QUX);
  when(append.mergeWriter(QUX)).thenReturn(BAZ);
}
