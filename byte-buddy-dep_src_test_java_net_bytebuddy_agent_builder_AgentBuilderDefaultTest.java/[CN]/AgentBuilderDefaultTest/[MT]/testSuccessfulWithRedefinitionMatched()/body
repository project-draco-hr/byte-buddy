{
  when(rawMatcher.matches(new TypeDescription.ForLoadedType(REDEFINED),REDEFINED.getClassLoader(),REDEFINED,REDEFINED.getProtectionDomain())).thenReturn(true);
  ClassFileLocator.Resolution resolution=mock(ClassFileLocator.Resolution.class);
  when(resolution.isResolved()).thenReturn(true);
  when(resolution.resolve()).thenReturn(QUX);
  when(classFileLocator.locate(REDEFINED.getName())).thenReturn(resolution);
  when(instrumentation.isModifiableClass(REDEFINED)).thenReturn(true);
  when(instrumentation.isRedefineClassesSupported()).thenReturn(true);
  ClassFileTransformer classFileTransformer=new AgentBuilder.Default(byteBuddy).with(initializationStrategy).with(AgentBuilder.RedefinitionStrategy.REDEFINITION).with(binaryLocator).with(typeStrategy).with(listener).disableNativeMethodPrefix().with(accessControlContext).type(rawMatcher).transform(transformer).installOn(instrumentation);
  verifyZeroInteractions(listener);
  verify(instrumentation).addTransformer(classFileTransformer,false);
  verify(instrumentation).getAllLoadedClasses();
  verify(instrumentation).isModifiableClass(REDEFINED);
  verify(instrumentation).redefineClasses(any(ClassDefinition[].class));
  verify(instrumentation).isRedefineClassesSupported();
  verifyNoMoreInteractions(instrumentation);
  verify(rawMatcher).matches(new TypeDescription.ForLoadedType(REDEFINED),REDEFINED.getClassLoader(),REDEFINED,REDEFINED.getProtectionDomain());
  verifyNoMoreInteractions(rawMatcher);
  verifyZeroInteractions(dispatcher);
  verify(resolution).resolve();
  verifyNoMoreInteractions(resolution);
}
