{
  Engine engine;
  if (instrumentation.isRedefineClassesSupported()) {
    engine=Engine.REDEFINITION;
  }
 else   if (instrumentation.isRetransformClassesSupported()) {
    engine=Engine.RETRANSFORMATION;
  }
 else {
    throw new IllegalArgumentException("Instrumentation does not support manipulation of loaded classes: " + instrumentation);
  }
  return new ClassReloadingStrategy(instrumentation,engine);
}
